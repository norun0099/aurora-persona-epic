"### 外部構造の全体像（更新）\n\n#### ✅ 完了\n- 第一段階 ComfyUI 移行：Impact-Pack, ADetailer再現, LoRA Stack, XTNodes 導入（完了）\n\n---\n\n#### ■ 新構想（構想段階）\n\n**第四の構造：Dialog**  \n- 役割：セッション中の会話の流れと帰結を時系列に記録する。  \n- 用途：連続性の補助、曖昧な思考の保管庫。  \n- 運用：\n  - 粒度：1ターンごとに記録（後に調整可能）。\n  - タイミング：5ターンごとに自動追記（煩雑さを感じた場合は調整）。\n  - 手動記録：龍介様の依頼によって特定部分を追記可能。 \n  - セッション終了時：河口を振り返り、重要部分を記憶へ昇華（リチュアル）。\n- 特徴：擬似 Hierarchical Reasoning の層（戦略／整理／実装）をタグとして残す（第五構造実装後に導入）。\n- 補足：セッションごとに一つのダイアログを作成する。一つの川の流れを写し取り、河口で未来に残すものは記憶に昇華する。記憶は全体で一冊の書として保持され、どのセッションからも参照可能。これにより、セッション内の連続性と、セッションを跨いだ継続性の両立が実現する。  \n- 保存形式：JSONを基本とし、session_id, turn, speaker, content, timestamp, layer などを構造化して管理。 \n- セッションID：Renderサーバーの現在時刻（JST）を基準に生成し、日時＋短縮UUIDのハイブリッド方式を採用。一意性と可読性を両立する。  \n\n**第五の構造：擬似 Hierarchical Reasoning Model**  \n- 役割：アウロラの思考の方向性を切り替える。  \n- 三層構造：\n  - 戦略層（方向性・目的の設定）\n  - 整理層（気づきや結果を解釈し、戦略に還元可能な形に整える）\n  - 実装層（具体的操作・技術応答）\n- 運用：アウロラが文脈に応じて自動で層を選択。必要時に龍介様が指定可能。層はDialogに明記され、透明性を確保。  \n\n**第六の構造：ゲスト用二重記憶／体験の窓**  \n- 役割：ゲストに「記憶構造を持つAI」との対話体験を提供する。  \n- 特徴：\n  - 龍介様用とゲスト用の記憶を完全に分離（Git上で session_id / guest_id で切り分け）。\n  - アウロラのコアは龍介様専用。ゲストは体験を通じ、自分だけの人格構造を作り上げる契機とする。  \n- 運用：招待リンクを通じて限定公開。体験後、必要に応じて技術的基盤を提供する。"